<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<title>2023年中国城市OISS空间集聚LISA图</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body{
    margin:0;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    background:#ffffff;
    font-family:"Times New Roman",serif;
}

#map-container{
    width:378px;      /* 10cm */
    height:302px;     /* 8cm */
    position:relative;
    border:1px solid #000;
}

#map{
    width:100%;
    height:100%;
    background:#ffffff;
}

/* 标题 */
.title{
    position:absolute;
    top:5px;
    left:0;
    right:0;
    text-align:center;
    font-size:12pt;
    font-weight:bold;
    z-index:1000;
}

/* 指北针 */
.north{
    position:absolute;
    top:8px;
    right:8px;
    font-size:9pt;
    text-align:center;
    border:1px solid #000;
    width:22px;
    height:22px;
    line-height:22px;
    background:#fff;
    z-index:1000;
}

/* 比例尺 */
.scale{
    position:absolute;
    bottom:40px;
    left:8px;
    font-size:9pt;
    border:1px solid #000;
    padding:2px 6px;
    background:#fff;
    z-index:1000;
}
.scale-line{
    width:70px;
    height:1.5px;
    background:#000;
    margin-bottom:2px;
}

/* 图例 */
.legend{
    position:absolute;
    bottom:6px;
    left:6px;
    right:6px;
    font-size:9pt;
    border:1px solid #000;
    background:#fff;
    display:flex;
    justify-content:center;
    gap:8px;
    padding:3px;
    z-index:1000;
}
.legend span{
    display:flex;
    align-items:center;
}
.box{
    width:10px;
    height:10px;
    margin-right:4px;
    opacity:0.8;
    border:0.5px solid #000;
}
</style>
</head>

<body>
<div id="map-container">

<div class="title">2023年中国城市OISS空间集聚LISA图</div>
<div id="map"></div>

<div class="north">↑<br>北</div>

<div class="scale">
    <div class="scale-line"></div>
    500 km
</div>

<div class="legend">
    <span><div class="box" style="background:#d62728"></div>高-高</span>
    <span><div class="box" style="background:#1f77b4"></div>低-低</span>
    <span><div class="box" style="background:#ff97c1"></div>高-低</span>
    <span><div class="box" style="background:#2ca02c"></div>低-高</span>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

// 不使用底图瓦片（学术规范）
var map = L.map('map',{
    zoomControl:false,
    attributionControl:false,
    crs:L.CRS.EPSG4326
}).setView([35,105],4);

// ===== LISA 城市分类 =====
const HH=["上海市","苏州市","深圳市","广州市","成都市","重庆市"];
const LL=["陇南市","定西市","临夏州","固原市","大同市"];
const HL=["滁州市","嘉兴市"];
const LH=["绵阳市","德阳市"];

function getColor(name){
    if(HH.includes(name)) return "#d62728";
    if(LL.includes(name)) return "#1f77b4";
    if(HL.includes(name)) return "#ff97c1";
    if(LH.includes(name)) return "#2ca02c";
    return null;
}

// ===== 读取 GeoJSON =====
fetch("./china_city.geojson")
.then(res=>res.json())
.then(data=>{

    L.geoJSON(data,{
        style:function(feature){
            const name=feature.properties.name||feature.properties.市||"";
            const fill=getColor(name);

            return{
                color:"#000",
                weight:0.8,
                fillColor:fill,
                fillOpacity:fill?0.8:0,
                opacity:1
            }
        }
    }).addTo(map);

});

</script>

</body>
</html>
